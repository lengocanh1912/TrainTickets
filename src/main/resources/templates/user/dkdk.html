<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Đặt vé tàu online</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link th:href="@{/img/favicon.ico}" rel="shortcut icon" type="image/x-icon">
  <!-- Bootstrap v5.0.1 -->
  <link th:href="@{/css/bootstrap.css}" type="text/css" rel="stylesheet">
  <script th:src="@{/js/bootstrap.bundle.js}" type="text/javascript"></script>
  <!-- Bootstrap Icons v1.5.0 -->
  <link th:href="@{/static/css/bootstrap-icons.css}" type="text/css" rel="stylesheet">
  <!-- Custom Styles -->
  <link th:href="@{/css/styles.css}" type="text/css" rel="stylesheet">
  <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
  <link rel="stylesheet" th:href="@{/css/layout.css}">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEJ10x8bH8tQy4bm8a7Unw7CkCz7Y2pA8a6vFtvbA0hZTkNffpV8V4jeIm9xr" crossorigin="anonymous">
  <!-- Bootstrap Icons (optional, for the account icon) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>

  <script>
    var changeLanguage = function (dom) {
      window.location.href = '?lang=' + dom.value;
    }
  </script>
  <style>
    body {
      /*background: url('/img/backG.png') no-repeat center center/cover;*/
      background: url('/img/backG.png') ;
      min-height: 100vh;
      font-family: sans-serif;
      /*padding-top: 70px;*/
    }

    .booking-form {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 10px;
      padding: 40px;
    }

    .form-section {
      max-width: 1000px;
      margin: 100px auto 30px;

    }

    .title {
      color: white;
      text-shadow: 1px 1px 2px black;
    }

    footer {
      background: white;
      /*padding: 20px;*/
      text-align: center;
    }

    /* New beautiful form styles */
    .beautiful-form-container {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
      padding: 40px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      margin: 20px auto;
      margin-top: 2cm;
      max-width: 900px;
    }

    .form-header {
      text-align: center;
      margin-bottom: 30px;
    }

    .form-title {
      font-size: 2.2rem;
      color: #333;
      margin-bottom: 10px;
      font-weight: 700;
      background: linear-gradient(135deg, #667eea, #764ba2);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .form-subtitle {
      color: #666;
      font-size: 1.1rem;
    }

    .ticket-type {
      display: flex;
      gap: 20px;
      margin-bottom: 30px;
      justify-content: center;
    }

    .ticket-option {
      position: relative;
    }

    .ticket-option input[type="radio"] {
      display: none;
    }

    .ticket-option label {
      display: flex;
      align-items: center;
      padding: 15px 25px;
      background: #f8f9fa;
      border: 2px solid #e9ecef;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 500;
      color: #495057;
    }

    .ticket-option input[type="radio"]:checked + label {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      border-color: #667eea;
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
    }

    .form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 30px;
    }

    .form-group {
      position: relative;
    }

    .form-group.full-width {
      grid-column: 1 / -1;
    }

    .form-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #333;
      font-size: 0.95rem;
    }

    .form-input, .form-select, .beautiful-input {
      width: 100%;
      padding: 15px;
      border: 2px solid #e9ecef;
      border-radius: 12px;
      font-size: 1rem;
      transition: all 0.3s ease;
      background: #fff;
      color: #495057;
    }

    .form-input:focus, .form-select:focus, .beautiful-input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      transform: translateY(-1px);
    }

    .date-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    .return-date {
      opacity: 0.5;
      pointer-events: none;
      transition: all 0.3s ease;
    }

    .return-date.active {
      opacity: 1;
      pointer-events: auto;
    }

    .quantity-group {
      display: flex;
      gap: 15px;
    }

    .quantity-item {
      flex: 1;
    }

    .search-btn {
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, #ff6b6b, #ee5a52);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 1.2rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 8px 20px rgba(238, 90, 82, 0.3);
    }

    .search-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 25px rgba(238, 90, 82, 0.4);
    }

    .search-btn:active {
      transform: translateY(0);
    }

    .swap-btn {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #667eea;
      color: white;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 10;
      box-shadow: 0 4px 10px rgba(102, 126, 234, 0.3);
    }

    .swap-btn:hover {
      background: #5a6fd8;
      transform: translate(-50%, -50%) rotate(180deg);
    }

    .stations-container {
      position: relative;
    }

    .icon {
      margin-right: 8px;
      font-weight: bold;
    }

    @media (max-width: 768px) {
      .beautiful-form-container {
        padding: 30px 20px;
        margin: 10px;
      }

      .form-title {
        font-size: 1.8rem;
      }

      .form-grid {
        grid-template-columns: 1fr;
      }

      .ticket-type {
        flex-direction: column;
        gap: 15px;
      }

      .date-grid {
        grid-template-columns: 1fr;
      }

      .quantity-group {
        flex-direction: column;
        gap: 15px;
      }
    }
  </style>
</head>
<body class="bg-cover bg-center min-h-screen"
      style="background-image: url('https://res.ivivu.com/train/images/bg-train.jpg');">

<!-- Navbar-->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
  <div class="container-fluid px-5 ">
    <a class="navbar-brand" href="#">TrainTicket</a>
    <div class="navbar-nav">
      <a class="nav-link text-white" th:href="@{/user/home}"
         th:classappend="${menu == 'userHome'} ? 'active' ">Home</a>
      <a class="nav-link text-white" th:href="@{/user/trip/list}"
         th:classappend="${menu == 'trip'} ? 'active'">Trip</a>
      <a class="nav-link text-white" href="#">Train Seat</a>
      <a class="nav-link text-white" th:href="@{/user/support}"
         th:classappend="${menu == 'support'} ? 'active'">Support</a>
      <a class="nav-link text-white" href="#">Q&A</a>
    </div>

    <div class="d-flex text-white ms-auto">
      <!--            <button class="btn btn-light" type="button">-->
      <a th:href="@{/user/trip/list}" class="nav-link text-white">
        <i class="bi bi-cart "> Đơn hàng</i>
      </a>
      <div class="dropdown">
        <!-- Nút icon tài khoản -->
        <button class="btn btn-light" type="button" id="accountDropdown" data-bs-toggle="dropdown" aria-expanded="false">
          <i class="bi bi-person"></i>
          <span th:if="${currentUser != null}"
                th:text="${currentUser.fullname}"></span>
          <span th:if="${currentUser == null}">Tài khoản</span>
        </button>

        <!-- Danh sách tùy chọn -->
        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="accountDropdown">
          <!-- Nếu đã đăng nhập -->
          <li th:if="${currentUser != null}">
            <a class="dropdown-item text-primary" th:each="role : ${currentUser.role}"
               th:if="${role == 'ADMIN'}"
               th:href="@{/admin/home}">ADMIN</a>
            <hr class="" >
          </li>
          <li th:if="${currentUser != null}">
            <a class="dropdown-item" th:href="@{/cart/checkout}">Checkout</a>
          </li>
          <li th:if="${currentUser != null}">
            <a class="dropdown-item" th:href="@{/cart/checkout-vnpay}">VNPAY</a>
          </li>
          <li th:if="${currentUser != null}">
            <a class="dropdown-item" th:href="@{/orders}">Đơn hàng</a>
          </li>
          <li th:if="${currentUser != null}">
            <a class="dropdown-item" th:href="@{/wishlist}">Yêu thích</a>
          </li>
          <li th:if="${currentUser != null}">
            <a class="dropdown-item" th:href="@{/logout}">Đăng xuất</a>
          </li>

          <!-- Nếu chưa đăng nhập -->
          <li th:if="${currentUser == null}">
            <a class="dropdown-item" th:href="@{/login}">Đăng nhập</a>
          </li>
          <li th:if="${currentUser == null}">
            <a class="dropdown-item" th:href="@{/register}">Tạo tài khoản</a>
          </li>

        </ul>
      </div>


    </div>
  </div>
</nav>

<div class="bg-black/5 min-h-screen flex items-center justify-center px-4">
  <div class="beautiful-form-container">
    <div class="form-header">
      <h1 class="form-title">🚂 Đặt vé tàu hỏa online</h1>
      <p class="form-subtitle">
        Nhận ngay vé điện tử - lên tàu nhanh!
        <span class="ml-4 bg-red-100 text-red-600 px-3 py-1 rounded-full text-sm font-medium">
                    🔥 1000 khách đặt vé trong 24 giờ qua
                </span>
      </p>
      <p class="text-gray-700 mt-1 flex items-center justify-center">
        <span class="ml-3 text-white bg-green-600 rounded px-2 font-semibold">9.6</span>
        <a href="#" class="underline text-blue-600 ml-1">37 đánh giá</a>
      </p>
    </div>

    <!-- Beautiful Form -->
    <form id="trainBookingForm" method="post" th:action="@{/user/trip/search}">
      <!-- Loại vé -->
      <div class="ticket-type">
        <div class="ticket-option">
          <input type="radio" id="roundtrip" name="tripType" value="roundtrip">
          <label for="roundtrip">
            <span class="icon">⇄</span>
            Khứ hồi
          </label>
        </div>
        <div class="ticket-option">
          <input type="radio" id="oneway" name="tripType" value="oneway" checked>
          <label for="oneway">
            <span class="icon">→</span>
            Một chiều
          </label>
        </div>
      </div>

      <!-- Ga đi và ga đến -->
      <div class="stations-container">
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label" for="departure">🚉 Ga đi</label>
            <input list="stationF" type="text" name="departureName"
                   placeholder="Chọn ga đi"
                   class="beautiful-input" required>
            <datalist id="stationF">
              <option th:each="station : ${stations}"
                      th:text="${station.name}">
              </option>
            </datalist>
          </div>
          <div class="form-group">
            <label class="form-label" for="destination">🎯 Ga đến</label>
            <input list="stationT" type="text" name="arrivalName"
                   placeholder="Chọn ga đến"
                   class="beautiful-input" required>
            <datalist id="stationT">
              <option th:each="station : ${stations}"
                      th:text="${station.name}">
              </option>
            </datalist>
          </div>
        </div>
        <button type="button" class="swap-btn" onclick="swapStations()">⇄</button>
      </div>

      <!-- Ngày đi và ngày về -->
      <div class="date-grid">
        <div class="form-group">
          <label class="form-label" for="departureDate">📅 Ngày đi</label>
          <input type="date" class="beautiful-input" id="departureDate" name="departureDate" required>
        </div>
        <div class="form-group return-date" id="returnDateGroup">
          <label class="form-label" for="returnDate">📅 Ngày về</label>
          <input type="date" class="beautiful-input" id="returnDate" name="returnDate">
        </div>
      </div>

      <!-- Số lượng vé -->
      <div class="form-group full-width">
        <label class="form-label">👥 Số lượng vé</label>
        <div class="quantity-group">
          <div class="quantity-item">
            <input type="number" name="ticketQuantity" min="1" value="1"
                   class="beautiful-input" placeholder="Số lượng vé">
          </div>
        </div>
      </div>

      <!-- Nút tìm kiếm -->
      <button type="submit" class="search-btn">
        🔍 Tìm Chuyến Đi
      </button>
    </form>
  </div>
</div>


<!-- Footer / Support -->
<footer>
  <div class="form-section row">
    <div class="col-md-4">
      <p>🚆 Tìm chuyến tàu phù hợp<br /><small>Lựa chọn lịch trình linh hoạt</small></p>
    </div>
    <div class="col-md-4">
      <p>📩 Đặt vé nhanh, dễ dàng<br /><small>Nhận vé ngay sau khi đặt</small></p>
    </div>
    <div class="col-md-4">
      <p>📞 Luôn sẵn sàng hỗ trợ<br /><small>Phản hồi trong 15 phút qua điện thoại, Zalo</small></p>
    </div>
  </div>
</footer>

<div class="container-fluid px-5">
  <div class="px-5"><h1>Bản đồ tuyến đường sắt Việt Nam </h1></div>
  <h5 class="px-5 text-dark">Xem thông tin chi tiết về các tuyến tàu hỏa, lịch trình và điểm dừng</h5>
  <img th:src="@{/img/mapVN.png}" class="img-fluid px-5" >
</div>

<div class="container-fluid px-5">
  <div class="px-5"><h1>Đánh giá của khách hàng sử dụng dịch vụ đặt vé tàu hỏa iVIVU</h1></div>
</div>

<!--active-->
<script>
  const links = document.querySelectorAll('.nav-link');

  links.forEach(link => {
    link.addEventListener('click', function () {
      links.forEach(l => l.classList.remove('active')); // Bỏ active ở tất cả các mục
      this.classList.add('active'); // Thêm active cho mục vừa click
    });
  });
</script>

<script>
  // Xử lý chuyển đổi giữa một chiều và khứ hồi
  const ticketTypeRadios = document.querySelectorAll('input[name="tripType"]');
  const returnDateGroup = document.getElementById('returnDateGroup');
  const returnDateInput = document.getElementById('returnDate');

  ticketTypeRadios.forEach(radio => {
    radio.addEventListener('change', function() {
      if (this.value === 'roundtrip') {
        returnDateGroup.classList.add('active');
        returnDateInput.required = true;
      } else {
        returnDateGroup.classList.remove('active');
        returnDateInput.required = false;
        returnDateInput.value = '';
      }
    });
  });

  // Thiết lập ngày tối thiểu là hôm nay
  const today = new Date().toISOString().split('T')[0];
  document.getElementById('departureDate').min = today;
  document.getElementById('returnDate').min = today;

  // Cập nhật ngày về tối thiểu khi thay đổi ngày đi
  document.getElementById('departureDate').addEventListener('change', function() {
    document.getElementById('returnDate').min = this.value;
    if (document.getElementById('returnDate').value < this.value) {
      document.getElementById('returnDate').value = '';
    }
  });

  // Hàm đổi chỗ ga đi và ga đến
  function swapStations() {
    const departure = document.querySelector("input[name='departureName']");
    const destination = document.querySelector("input[name='arrivalName']");

    const temp = departure.value;
    departure.value = destination.value;
    destination.value = temp;
  }

  // Tự động chuyển sang khứ hồi khi chọn ngày về
  returnDateInput.addEventListener("change", () => {
    if (returnDateInput.value) {
      document.getElementById('roundtrip').checked = true;
      returnDateGroup.classList.add('active');
      returnDateInput.required = true;
    }
  });

  // Hiệu ứng focus cho các input
  const inputs = document.querySelectorAll('.beautiful-input');
  inputs.forEach(input => {
    input.addEventListener('focus', function() {
      this.parentElement.style.transform = 'translateY(-2px)';
    });

    input.addEventListener('blur', function() {
      this.parentElement.style.transform = 'translateY(0)';
    });
  });
</script>

</body>
</html>