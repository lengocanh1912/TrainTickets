<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ƒê·∫∑t v√© t√†u online</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link th:href="@{/img/favicon.ico}" rel="shortcut icon" type="image/x-icon">
  <!-- Bootstrap v5.0.1 -->
  <link th:href="@{/css/bootstrap.css}" type="text/css" rel="stylesheet">
  <script th:src="@{/js/bootstrap.bundle.js}" type="text/javascript"></script>
  <!-- Bootstrap Icons v1.5.0 -->
  <link th:href="@{/static/css/bootstrap-icons.css}" type="text/css" rel="stylesheet">
  <!-- Custom Styles -->
  <link th:href="@{/css/styles.css}" type="text/css" rel="stylesheet">
  <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
  <link rel="stylesheet" th:href="@{/css/layout.css}">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEJ10x8bH8tQy4bm8a7Unw7CkCz7Y2pA8a6vFtvbA0hZTkNffpV8V4jeIm9xr" crossorigin="anonymous">
  <!-- Bootstrap Icons (optional, for the account icon) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>

  <script>
    var changeLanguage = function (dom) {
      window.location.href = '?lang=' + dom.value;
    }
  </script>
  <!--narbar-->
  <style>
    body {
      /*background: url('/img/backG.png') no-repeat center center/cover;*/
      background: url('/img/backG.png') ;
      min-height: 100vh;
      font-family: sans-serif;
      /*padding-top: 70px;*/
    }

    .booking-form {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 10px;
      padding: 40px;
    }

    .form-section {
      max-width: 1000px;
      margin: 100px auto 30px;

    }


    .title {
      color: white;
      text-shadow: 1px 1px 2px black;
    }

    footer {
      background: white;
      /*padding: 20px;*/
      text-align: center;
    }
  </style>
  <style>
    /* Map section */
    .map-section {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(15px);
      border-radius: 1.5rem;
      padding: 3rem;
      margin-top: 3rem;
    }

    .map-section h1, .map-section h5 {
      color: #1f2937;
    }
  </style>
</head>
<body class="bg-cover bg-center min-h-screen"
      style="background-image: url('https://res.ivivu.com/train/images/bg-train.jpg');">

<!-- Navbar-->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
  <div class="container-fluid px-5 ">
    <a class="navbar-brand" href="#">TrainTicket</a>
    <div class="navbar-nav">
      <a class="nav-link text-white" th:href="@{/user/home}"
         th:classappend="${menu == 'userHome'} ? 'active' ">Home</a>
      <a class="nav-link text-white" th:href="@{/user/trip/list}"
         th:classappend="${menu == 'trip'} ? 'active'">Trip</a>
      <a class="nav-link text-white" href="#">Train Seat</a>
      <a class="nav-link text-white" th:href="@{/user/support}"
         th:classappend="${menu == 'support'} ? 'active'">Support</a>
      <a class="nav-link text-white" href="#">Q&A</a>
    </div>

    <div class="d-flex text-white ms-auto">
      <!--            <button class="btn btn-light" type="button">-->
      <a th:href="@{/user/order/view}" class="nav-link text-white">
        <i class="bi bi-cart "> ƒê∆°n h√†ng</i>
      </a>
      <div class="dropdown">
        <!-- N√∫t icon t√†i kho·∫£n -->
        <button class="btn btn-light" type="button" id="accountDropdown" data-bs-toggle="dropdown" aria-expanded="false">
          <i class="bi bi-person"></i>
          <span th:if="${currentUser != null}"
                th:text="${currentUser.fullname}"></span>
          <span th:if="${currentUser == null}">T√†i kho·∫£n</span>
        </button>

        <!-- Danh s√°ch t√πy ch·ªçn -->
        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="accountDropdown">
          <!-- N·∫øu ƒë√£ ƒëƒÉng nh·∫≠p -->
          <li th:if="${currentUser != null}">
            <a class="dropdown-item text-primary" th:each="role : ${currentUser.role}"
               th:if="${role == 'ADMIN'}"
               th:href="@{/admin/home}">ADMIN</a>
            <hr class="" >
          </li>
          <li th:if="${currentUser != null}">
            <a class="dropdown-item" th:href="@{/cart/checkout}">Checkout</a>
          </li>
          <li th:if="${currentUser != null}">
            <a class="dropdown-item" th:href="@{/cart/checkout-vnpay}">VNPAY</a>
          </li>
          <li th:if="${currentUser != null}">
            <a class="dropdown-item" th:href="@{/orders}">ƒê∆°n h√†ng</a>
          </li>
          <li th:if="${currentUser != null}">
            <a class="dropdown-item" th:href="@{/wishlist}">Y√™u th√≠ch</a>
          </li>
          <li th:if="${currentUser != null}">
            <a class="dropdown-item" th:href="@{/logout}">ƒêƒÉng xu·∫•t</a>
          </li>

          <!-- N·∫øu ch∆∞a ƒëƒÉng nh·∫≠p -->
          <li th:if="${currentUser == null}">
            <a class="dropdown-item" th:href="@{/login}">ƒêƒÉng nh·∫≠p</a>
          </li>
          <li th:if="${currentUser == null}">
            <a class="dropdown-item" th:href="@{/register}">T·∫°o t√†i kho·∫£n</a>
          </li>

        </ul>
      </div>


    </div>
  </div>
</nav>

<div class="bg-black/5 min-h-screen flex items-center justify-center px-4">
  <div class="bg-white rounded-xl shadow-lg w-full max-w-4xl p-10 ">
    <!-- Ti√™u ƒë·ªÅ -->
    <h1 class="text-2xl font-bold text-blue-800 flex items-center">
      ƒê·∫∑t v√© t√†u h·ªèa online
      <span class="ml-4 bg-red-100 text-red-600 px-3 py-1 rounded-full text-sm font-medium">
          üî• 1000 kh√°ch ƒë·∫∑t v√© trong 24 gi·ªù qua
        </span>
    </h1>
    <p class="text-gray-700 mt-1 flex items-center">
      Nh·∫≠n ngay v√© ƒëi·ªán t·ª≠ - l√™n t√†u nhanh!
      <span class="ml-3 text-white bg-green-600 rounded px-2 font-semibold">9.6</span>
      <a th:href="@{/user/review/list}" class="underline text-blue-600 ml-1">37 ƒë√°nh gi√°</a>
    </p>

    <!-- Form -->
    <form method="get" th:action="@{/user/trip/search}" class="mt-8 bg-white rounded-xl shadow-lg p-6 space-y-6">
      <!-- D√≤ng 1: Lo·∫°i v√© v√† s·ªë l∆∞·ª£ng -->
      <div class="flex flex-col md:flex-row items-start md:items-end gap-6">
        <!-- Lo·∫°i v√© -->
        <div>
          <label for="ticketType" class="block text-sm font-medium text-gray-700">Lo·∫°i v√©</label>
          <select id="ticketType" name="tripType" class="mt-1 block w-40 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
            <option value="oneway">M·ªôt chi·ªÅu</option>
            <option value="roundtrip">Kh·ª© h·ªìi</option>
          </select>
        </div>

        <!-- S·ªë l∆∞·ª£ng v√© -->
        <div class="relative w-full md:w-auto">
          <label class="block text-sm font-medium text-gray-700">S·ªë l∆∞·ª£ng v√©</label>
          <button id="ticketToggle" type="button" class="w-full md:w-64 mt-1 border rounded-md px-3 py-2 bg-white flex justify-between items-center">
            <span id="totalTicketCount">1 v√©</span>
            <i class="bi bi-chevron-down"></i>
          </button>

          <!-- Dropdown chi ti·∫øt s·ªë l∆∞·ª£ng v√© -->
          <div id="ticketDropdown" class="absolute top-full mt-2 z-50 bg-white border rounded-md shadow-lg p-4 space-y-4 hidden w-72">
            <!-- C√°c lo·∫°i v√© -->
            <div class="space-y-3">
              <template id="ticketRowTemplate">
                <div class="flex justify-between items-center">
                  <div>
                    <p class="font-medium">[[NAME]]</p>
                    <p class="text-xs text-gray-500">[[DESC]]</p>
                  </div>
                  <div class="flex items-center gap-2">
                    <button type="button" class="ticket-decrease px-2 py-1 bg-gray-200 rounded" data-type="[[TYPE]]">‚àí</button>
                    <span id="[[TYPE]]Count">0</span>
                    <button type="button" class="ticket-increase px-2 py-1 bg-gray-200 rounded" data-type="[[TYPE]]">+</button>
                    <input type="hidden" name="[[TYPE]]Quantity" value="0">
                  </div>
                </div>
              </template>

              <!-- Render t·ª´ng lo·∫°i v√© c·ª• th·ªÉ -->
              <div id="ticketRows"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- D√≤ng 2: Ga ƒëi, ga ƒë·∫øn, ng√†y ƒëi v√† ng√†y v·ªÅ -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        <!-- Ga ƒëi -->
        <div>
          <label class="block text-sm font-medium text-gray-700">Ga ƒëi</label>
          <input list="stationF" name="departureName" placeholder="Ch·ªçn ga ƒëi" class="mt-1 block w-full border rounded-md px-3 py-2 shadow-sm focus:border-blue-500 focus:ring-blue-500" required>
          <datalist id="stationF">
            <option th:each="station : ${stations}" th:text="${station.name}"></option>
          </datalist>
        </div>

        <!-- Ga ƒë·∫øn -->
        <div>
          <label class="block text-sm font-medium text-gray-700">Ga ƒë·∫øn</label>
          <input list="stationT" name="arrivalName" placeholder="Ch·ªçn ga ƒë·∫øn"
                 class="mt-1 block w-full border rounded-md px-3 py-2 shadow-sm focus:border-blue-500 focus:ring-blue-500" required>
          <datalist id="stationT">
            <option th:each="station : ${stations}" th:text="${station.name}"></option>
          </datalist>
        </div>

        <!-- Ng√†y ƒëi -->
        <div class="flex flex-col">
          <label class="text-sm text-gray-600 mx-auto mb-1">Ng√†y ƒëi</label>
          <input type="text" id="departureDate" name="departureDate"
                 placeholder="ch·ªçn ng√†y ƒëi"
                 class="border rounded-md px-4 py-2 text-lg  text-gray-500"
                 onfocus="this.type='date'; this.classList.remove('text-gray-500')"
                 onblur="if (!this.value) { this.type='text'; this.classList.add('text-gray-500') }">
        </div>
        <div class="flex flex-col">
                              <label class="text-sm text-gray-600 mx-auto mb-1">Ng√†y v·ªÅ</label>
          <input type="text" id="returnDate" name="returnDate"
                 placeholder="ch·ªçn ng√†y v·ªÅ"
                 class="border rounded-md px-4 py-2 text-lg  text-gray-500"
                 onfocus="this.type='date'; this.classList.remove('text-gray500')"
                 onblur="if (!this.value) { this.type='text'; this.classList.add('text-gray-500') }">
        </div>
      </div>

      <!-- N√∫t t√¨m chuy·∫øn -->
      <div class="flex justify-center">
        <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-2 rounded-md">
          T√¨m chuy·∫øn
        </button>
      </div>
    </form>
  </div>
</div>


<!-- Footer / Support -->
<footer>
  <div class="form-section row">
    <div class="col-md-4">
      <p>üöÜ T√¨m chuy·∫øn t√†u ph√π h·ª£p<br /><small>L·ª±a ch·ªçn l·ªãch tr√¨nh linh ho·∫°t</small></p>
    </div>
    <div class="col-md-4">
      <p>üì© ƒê·∫∑t v√© nhanh, d·ªÖ d√†ng<br /><small>Nh·∫≠n v√© ngay sau khi ƒë·∫∑t</small></p>
    </div>
    <div class="col-md-4">
      <p>üìû Lu√¥n s·∫µn s√†ng h·ªó tr·ª£<br /><small>Ph·∫£n h·ªìi trong 15 ph√∫t qua ƒëi·ªán tho·∫°i, Zalo</small></p>
    </div>
  </div>
</footer>

<div class="container-fluid px-5">
  <div class="px-5"><h1>B·∫£n ƒë·ªì tuy·∫øn ƒë∆∞·ªùng s·∫Øt Vi·ªát Nam </h1></div>
  <h5 class="px-5 text-dark">Xem th√¥ng tin chi ti·∫øt v·ªÅ c√°c tuy·∫øn t√†u h·ªèa, l·ªãch tr√¨nh v√† ƒëi·ªÉm d·ª´ng</h5>
  <img th:src="@{/img/mapVN.png}" class="img-fluid px-5" >
</div>

<!-- Map Section -->
<div class="container">
  <div class="map-section">
    <div class="px-3">
      <h1>B·∫£n ƒë·ªì tuy·∫øn ƒë∆∞·ªùng s·∫Øt Vi·ªát Nam</h1>
      <h5 class="text-muted mb-4">Xem th√¥ng tin chi ti·∫øt v·ªÅ c√°c tuy·∫øn t√†u h·ªèa, l·ªãch tr√¨nh v√† ƒëi·ªÉm d·ª´ng</h5>
      <div class="text-center bg-light rounded-4 p-5">
        <i class="bi bi-map display-1 text-muted"></i>
        <p class="text-muted mt-3">B·∫£n ƒë·ªì tuy·∫øn ƒë∆∞·ªùng s·∫Øt s·∫Ω hi·ªÉn th·ªã t·∫°i ƒë√¢y</p>
        <img th:src="@{/img/mapVN.png}" class="img-fluid" style="max-width: 100%; height: auto; border-radius: 1rem;">
      </div>
    </div>
  </div>
</div>
<!-- Customer Reviews Section -->
<div class="container">
  <div class="map-section">
    <div class="px-3">
      <h1>ƒê√°nh gi√° c·ªßa kh√°ch h√†ng s·ª≠ d·ª•ng d·ªãch v·ª• ƒë·∫∑t v√© t√†u h·ªèa</h1>
      <div class="text-center">
        <p class="text-muted">H√†ng ngh√¨n kh√°ch h√†ng tin t∆∞·ªüng s·ª≠ d·ª•ng d·ªãch v·ª• c·ªßa ch√∫ng t√¥i</p>
      </div>
    </div>
  </div>
</div>
<div class="container-fluid px-5">
  <div class="px-5"><h1>ƒê√°nh gi√° c·ªßa kh√°ch h√†ng s·ª≠ d·ª•ng d·ªãch v·ª• ƒë·∫∑t v√© t√†u h·ªèa iVIVU</h1></div>
</div>

<!--active-->
<script >
  const links = document.querySelectorAll('.nav-link');

  links.forEach(link => {
    link.addEventListener('click', function () {
      links.forEach(l => l.classList.remove('active')); // B·ªè active ·ªü t·∫•t c·∫£ c√°c m·ª•c
      this.classList.add('active'); // Th√™m active cho m·ª•c v·ª´a click
    });
  });
</script>

<script>
  const ticketTypeSelect = document.getElementById("ticketType");
  const returnDateInput = document.getElementById("returnDate");

  returnDateInput.addEventListener("change", () => {
    if (ticketTypeSelect.value === "oneway" && returnDateInput.value) {
      ticketTypeSelect.value = "roundtrip";
    }
  });
</script>
<script>
  document.querySelector("button[type='button']").addEventListener("click", () => {
    const from = document.querySelector("input[name='departureName']");
    const to = document.querySelector("input[name='arrivalName']");
    const temp = from.value;
    from.value = to.value;
    to.value = temp;
  });
</script>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const types = [
      { type: "adult", name: "Ng∆∞·ªùi l·ªõn", desc: "T·ª´ 11 - 59 tu·ªïi" },
      { type: "child", name: "Tr·∫ª em", desc: "T·ª´ 6 - 10 tu·ªïi (-25%)" },
      { type: "senior", name: "Ng∆∞·ªùi cao tu·ªïi", desc: "T·ª´ 60 tu·ªïi (-15%)" },
      { type: "student", name: "Sinh vi√™n", desc: "Th·∫ª sinh vi√™n (-10%)" },
    ];

    const ticketRows = document.getElementById("ticketRows");
    const template = document.getElementById("ticketRowTemplate").innerHTML;
    const totalText = document.getElementById("totalTicketCount");

    // Render h√†ng v√©
    types.forEach(t => {
      const html = template
              .replaceAll("[[NAME]]", t.name)
              .replaceAll("[[DESC]]", t.desc)
              .replaceAll("[[TYPE]]", t.type);
      ticketRows.insertAdjacentHTML("beforeend", html);
    });

    const updateTotal = () => {
      let total = 0;
      types.forEach(t => {
        const count = parseInt(document.getElementById(t.type + "Count").textContent);
        total += count;
      });
      totalText.textContent = `${total} v√©`;
    };

    // Toggle dropdown
    document.getElementById("ticketToggle").addEventListener("click", () => {
      document.getElementById("ticketDropdown").classList.toggle("hidden");
    });

    // C·ªông/tr·ª´ v√©
    document.addEventListener("click", (e) => {
      if (e.target.classList.contains("ticket-increase") || e.target.classList.contains("ticket-decrease")) {
        const type = e.target.dataset.type;
        const span = document.getElementById(type + "Count");
        let count = parseInt(span.textContent);
        if (e.target.classList.contains("ticket-increase")) count++;
        else if (count > 0) count--;
        span.textContent = count;

        const hiddenInput = document.querySelector(`input[name='${type}Quantity']`);
        if (hiddenInput) hiddenInput.value = count;

        updateTotal();
      }
    });

    updateTotal();
  });
</script>

<!--th·ªÉ lo·∫°i v√©(form)-->
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const toggleBtn = document.getElementById("ticketToggle");
    const dropdown = document.getElementById("ticketDropdown");
    const totalText = document.getElementById("totalTicketCount");

    // M·ªü/ƒë√≥ng dropdown ch·ªçn lo·∫°i v√©
    toggleBtn.addEventListener("click", () => {
      dropdown.classList.toggle("hidden");
    });

    // C·∫≠p nh·∫≠t t·ªïng s·ªë v√©
    const updateTotal = () => {
      const types = ["adult", "child", "senior", "student"];
      let total = 0;

      types.forEach(type => {
        const count = parseInt(document.getElementById(type + "Count").textContent);
        total += count;
      });

      totalText.textContent = `${total} v√©`;
    };

    // TƒÉng s·ªë l∆∞·ª£ng v√©
    document.querySelectorAll(".ticket-increase").forEach(button => {
      button.addEventListener("click", () => {
        const type = button.dataset.type;
        const countSpan = document.getElementById(type + "Count");
        let count = parseInt(countSpan.textContent);
        count++;
        countSpan.textContent = count;

        // G√°n l·∫°i gi√° tr·ªã v√†o input ·∫©n
        const hiddenInput = document.querySelector(`input[name="${type}Quantity"]`);
        if (hiddenInput) hiddenInput.value = count;

        updateTotal();
      });
    });

    // Gi·∫£m s·ªë l∆∞·ª£ng v√©
    document.querySelectorAll(".ticket-decrease").forEach(button => {
      button.addEventListener("click", () => {
        const type = button.dataset.type;
        const countSpan = document.getElementById(type + "Count");
        let count = parseInt(countSpan.textContent);
        if (count > 0) count--;
        countSpan.textContent = count;

        // G√°n l·∫°i gi√° tr·ªã v√†o input ·∫©n
        const hiddenInput = document.querySelector(`input[name="${type}Quantity"]`);
        if (hiddenInput) hiddenInput.value = count;

        updateTotal();
      });
    });

    // G·ªçi ngay t·ª´ ƒë·∫ßu ƒë·ªÉ hi·ªÉn th·ªã t·ªïng v√© ban ƒë·∫ßu
    updateTotal();
  });
</script>
<!--ng√†y th√°ng -->
<!--<script>-->
<!--    function getWeekday(dateStr) {-->
<!--        const weekdays = ['Ch·ªß nh·∫≠t', 'Th·ª© hai', 'Th·ª© ba', 'Th·ª© t∆∞', 'Th·ª© nƒÉm', 'Th·ª© s√°u', 'Th·ª© b·∫£y'];-->
<!--        const d = new Date(dateStr);-->
<!--        return weekdays[d.getDay()];-->
<!--    }-->

<!--    function formatDateVN(dateStr) {-->
<!--        const d = new Date(dateStr);-->
<!--        const day = String(d.getDate()).padStart(2, '0');-->
<!--        const month = String(d.getMonth() + 1).padStart(2, '0');-->
<!--        const year = d.getFullYear();-->
<!--        return `${day}-${month}-${year}`;-->
<!--    }-->

<!--    // DOM Elements-->
<!--    const depInput = document.getElementById("departureDate");-->
<!--    const depDay = document.getElementById("departureDay");-->
<!--    const depFormatted = document.getElementById("departureFormatted");-->

<!--    const returnInput = document.getElementById("returnDate");-->
<!--    const returnDay = document.getElementById("returnDay");-->
<!--    const returnFormatted = document.getElementById("returnFormatted");-->

<!--    // G√°n ng√†y h√¥m nay cho ng√†y ƒëi khi load-->
<!--    window.addEventListener("DOMContentLoaded", () => {-->
<!--        const today = new Date().toISOString().split("T")[0]; // yyyy-mm-dd-->
<!--        depInput.value = today;-->
<!--        depDay.textContent = getWeekday(today);-->
<!--        depFormatted.textContent = formatDateVN(today);-->
<!--    });-->

<!--    // Khi ng∆∞·ªùi d√πng ch·ªçn l·∫°i ng√†y ƒëi-->
<!--    depInput.addEventListener("change", function () {-->
<!--        if (this.value) {-->
<!--            depDay.textContent = getWeekday(this.value);-->
<!--            depFormatted.textContent = formatDateVN(this.value);-->
<!--        }-->
<!--    });-->

<!--    // Khi ng∆∞·ªùi d√πng ch·ªçn ng√†y v·ªÅ-->
<!--    returnInput.addEventListener("change", function () {-->
<!--        if (this.value) {-->
<!--            returnDay.textContent = getWeekday(this.value);-->
<!--            returnFormatted.textContent = formatDateVN(this.value);-->
<!--            returnFormatted.classList.remove("text-gray-500");-->
<!--            returnFormatted.classList.add("text-black", "font-semibold");-->
<!--        }-->
<!--    });-->
<!--</script>-->
</body>
</html>
